package com.spop.poverlay.ble

import java.util.*

/**
 * FTMS (Fitness Machine Service) UUIDs and constants
 * Based on the Bluetooth SIG specification for FTMS
 */
object FtmsUuids {
    
    // FTMS Service UUID
    val FITNESS_MACHINE_SERVICE_UUID: UUID = UUID.fromString("00001826-0000-1000-8000-00805f9b34fb")
    
    // FTMS Characteristics
    val FITNESS_MACHINE_FEATURE_UUID: UUID = UUID.fromString("00002ACC-0000-1000-8000-00805f9b34fb")
    val INDOOR_BIKE_DATA_UUID: UUID = UUID.fromString("00002AD2-0000-1000-8000-00805f9b34fb")
    val TRAINING_STATUS_UUID: UUID = UUID.fromString("00002AD3-0000-1000-8000-00805f9b34fb")
    val SUPPORTED_SPEED_RANGE_UUID: UUID = UUID.fromString("00002AD4-0000-1000-8000-00805f9b34fb")
    val SUPPORTED_INCLINATION_RANGE_UUID: UUID = UUID.fromString("00002AD5-0000-1000-8000-00805f9b34fb")
    val SUPPORTED_RESISTANCE_LEVEL_RANGE_UUID: UUID = UUID.fromString("00002AD6-0000-1000-8000-00805f9b34fb")
    val SUPPORTED_HEART_RATE_RANGE_UUID: UUID = UUID.fromString("00002AD7-0000-1000-8000-00805f9b34fb")
    val SUPPORTED_POWER_RANGE_UUID: UUID = UUID.fromString("00002AD8-0000-1000-8000-00805f9b34fb")
    val FITNESS_MACHINE_CONTROL_POINT_UUID: UUID = UUID.fromString("00002AD9-0000-1000-8000-00805f9b34fb")
    val FITNESS_MACHINE_STATUS_UUID: UUID = UUID.fromString("00002ADA-0000-1000-8000-00805f9b34fb")
    
    // Standard BLE UUIDs
    val CLIENT_CHARACTERISTIC_CONFIG_UUID: UUID = UUID.fromString("00002902-0000-1000-8000-00805f9b34fb")
    val CHARACTERISTIC_USER_DESCRIPTION_UUID: UUID = UUID.fromString("00002901-0000-1000-8000-00805f9b34fb")
    
    // Device Information Service
    val DEVICE_INFORMATION_SERVICE_UUID: UUID = UUID.fromString("0000180A-0000-1000-8000-00805f9b34fb")
    val DEVICE_NAME_UUID: UUID = UUID.fromString("00002A00-0000-1000-8000-00805f9b34fb")
    val MANUFACTURER_NAME_UUID: UUID = UUID.fromString("00002A29-0000-1000-8000-00805f9b34fb")
    val MODEL_NUMBER_UUID: UUID = UUID.fromString("00002A24-0000-1000-8000-00805f9b34fb")
    val SERIAL_NUMBER_UUID: UUID = UUID.fromString("00002A25-0000-1000-8000-00805f9b34fb")
    val HARDWARE_REVISION_UUID: UUID = UUID.fromString("00002A27-0000-1000-8000-00805f9b34fb")
    val FIRMWARE_REVISION_UUID: UUID = UUID.fromString("00002A26-0000-1000-8000-00805f9b34fb")
    val SOFTWARE_REVISION_UUID: UUID = UUID.fromString("00002A28-0000-1000-8000-00805f9b34fb")
}

/**
 * FTMS constants and feature flags
 */
object FtmsConstants {
    
    // Fitness Machine Feature flags (4 bytes)
    const val AVERAGE_SPEED_SUPPORTED = 0x00000001
    const val CADENCE_SUPPORTED = 0x00000002
    const val TOTAL_DISTANCE_SUPPORTED = 0x00000004
    const val INCLINATION_SUPPORTED = 0x00000008
    const val ELEVATION_GAIN_SUPPORTED = 0x00000010
    const val PACE_SUPPORTED = 0x00000020
    const val STEP_COUNT_SUPPORTED = 0x00000040
    const val RESISTANCE_LEVEL_SUPPORTED = 0x00000080
    const val STRIDE_COUNT_SUPPORTED = 0x00000100
    const val EXPENDED_ENERGY_SUPPORTED = 0x00000200
    const val HEART_RATE_MEASUREMENT_SUPPORTED = 0x00000400
    const val METABOLIC_EQUIVALENT_SUPPORTED = 0x00000800
    const val ELAPSED_TIME_SUPPORTED = 0x00001000
    const val REMAINING_TIME_SUPPORTED = 0x00002000
    const val POWER_MEASUREMENT_SUPPORTED = 0x00004000
    const val FORCE_ON_BELT_MEASUREMENT_SUPPORTED = 0x00008000
    const val USER_DATA_RETENTION_SUPPORTED = 0x00010000
    
    // Target Setting Features (4 bytes)
    const val SPEED_TARGET_SETTING_SUPPORTED = 0x00000001
    const val INCLINATION_TARGET_SETTING_SUPPORTED = 0x00000002
    const val RESISTANCE_TARGET_SETTING_SUPPORTED = 0x00000004
    const val POWER_TARGET_SETTING_SUPPORTED = 0x00000008
    const val HEART_RATE_TARGET_SETTING_SUPPORTED = 0x00000010
    const val TARGETED_EXPENDED_ENERGY_CONFIGURATION_SUPPORTED = 0x00000020
    const val TARGETED_STEP_NUMBER_CONFIGURATION_SUPPORTED = 0x00000040
    const val TARGETED_STRIDE_NUMBER_CONFIGURATION_SUPPORTED = 0x00000080
    const val TARGETED_DISTANCE_CONFIGURATION_SUPPORTED = 0x00000100
    const val TARGETED_TRAINING_TIME_CONFIGURATION_SUPPORTED = 0x00000200
    const val TARGETED_TIME_IN_TWO_HEART_RATE_ZONES_CONFIGURATION_SUPPORTED = 0x00000400
    const val TARGETED_TIME_IN_THREE_HEART_RATE_ZONES_CONFIGURATION_SUPPORTED = 0x00000800
    const val TARGETED_TIME_IN_FIVE_HEART_RATE_ZONES_CONFIGURATION_SUPPORTED = 0x00001000
    const val INDOOR_BIKE_SIMULATION_PARAMETERS_SUPPORTED = 0x00002000
    const val WHEEL_CIRCUMFERENCE_CONFIGURATION_SUPPORTED = 0x00004000
    const val SPIN_DOWN_CONTROL_SUPPORTED = 0x00008000
    const val TARGETED_CADENCE_CONFIGURATION_SUPPORTED = 0x00010000
    
    // Indoor Bike supported features
    const val INDOOR_BIKE_FEATURES: Long = (
        AVERAGE_SPEED_SUPPORTED or
        CADENCE_SUPPORTED or
        TOTAL_DISTANCE_SUPPORTED or
        RESISTANCE_LEVEL_SUPPORTED or
        EXPENDED_ENERGY_SUPPORTED or
        HEART_RATE_MEASUREMENT_SUPPORTED or
        METABOLIC_EQUIVALENT_SUPPORTED or
        ELAPSED_TIME_SUPPORTED or
        POWER_MEASUREMENT_SUPPORTED
    ).toLong()
    
    const val INDOOR_BIKE_TARGET_SETTINGS: Long = (
        RESISTANCE_TARGET_SETTING_SUPPORTED or
        POWER_TARGET_SETTING_SUPPORTED or
        TARGETED_EXPENDED_ENERGY_CONFIGURATION_SUPPORTED or
        TARGETED_TRAINING_TIME_CONFIGURATION_SUPPORTED or
        TARGETED_DISTANCE_CONFIGURATION_SUPPORTED
    ).toLong()
    
    // Machine Types
    const val MACHINE_TYPE_INDOOR_BIKE = 0x00000008
    
    // Control Point Op Codes
    const val FTMS_CONTROL_REQUEST_CONTROL = 0x00.toByte()
    const val FTMS_CONTROL_RESET = 0x01.toByte()
    const val FTMS_CONTROL_SET_TARGET_SPEED = 0x02.toByte()
    const val FTMS_CONTROL_SET_TARGET_INCLINATION = 0x03.toByte()
    const val FTMS_CONTROL_SET_TARGET_RESISTANCE_LEVEL = 0x04.toByte()
    const val FTMS_CONTROL_SET_TARGET_POWER = 0x05.toByte()
    const val FTMS_CONTROL_SET_TARGET_HEART_RATE = 0x06.toByte()
    const val FTMS_CONTROL_START_OR_RESUME = 0x07.toByte()
    const val FTMS_CONTROL_STOP_OR_PAUSE = 0x08.toByte()
    const val FTMS_CONTROL_SET_TARGETED_EXPENDED_ENERGY = 0x09.toByte()
    const val FTMS_CONTROL_SET_TARGETED_NUMBER_OF_STEPS = 0x0A.toByte()
    const val FTMS_CONTROL_SET_TARGETED_NUMBER_OF_STRIDES = 0x0B.toByte()
    const val FTMS_CONTROL_SET_TARGETED_DISTANCE = 0x0C.toByte()
    const val FTMS_CONTROL_SET_TARGETED_TRAINING_TIME = 0x0D.toByte()
    const val FTMS_CONTROL_SET_TARGETED_TIME_IN_TWO_HEART_RATE_ZONES = 0x0E.toByte()
    const val FTMS_CONTROL_SET_TARGETED_TIME_IN_THREE_HEART_RATE_ZONES = 0x0F.toByte()
    const val FTMS_CONTROL_SET_TARGETED_TIME_IN_FIVE_HEART_RATE_ZONES = 0x10.toByte()
    const val FTMS_CONTROL_SET_INDOOR_BIKE_SIMULATION_PARAMETERS = 0x11.toByte()
    const val FTMS_CONTROL_SET_WHEEL_CIRCUMFERENCE = 0x12.toByte()
    const val FTMS_CONTROL_SPIN_DOWN_CONTROL = 0x13.toByte()
    const val FTMS_CONTROL_SET_TARGETED_CADENCE = 0x14.toByte()
    
    // Response codes
    const val FTMS_RESPONSE_SUCCESS = 0x01.toByte()
    const val FTMS_RESPONSE_OP_CODE_NOT_SUPPORTED = 0x02.toByte()
    const val FTMS_RESPONSE_INVALID_PARAMETER = 0x03.toByte()
    const val FTMS_RESPONSE_OPERATION_FAILED = 0x04.toByte()
    const val FTMS_RESPONSE_CONTROL_NOT_PERMITTED = 0x05.toByte()
    
    // Status codes
    const val STATUS_RESET = 0x01.toByte()
    const val STATUS_STARTED_BY_USER = 0x02.toByte()
    const val STATUS_STOPPED_BY_USER = 0x03.toByte()
    const val STATUS_STOPPED_BY_SAFETY_KEY = 0x04.toByte()
    const val STATUS_PAUSED_BY_USER = 0x05.toByte()
    const val STATUS_PAUSED_BY_SAFETY_KEY = 0x06.toByte()
    const val STATUS_RESUMED_BY_USER = 0x07.toByte()
    const val STATUS_STARTED_BY_EXTERNAL = 0x08.toByte()
    const val STATUS_STOPPED_BY_EXTERNAL = 0x09.toByte()
    const val STATUS_PAUSED_BY_EXTERNAL = 0x0A.toByte()
    const val STATUS_RESUMED_BY_EXTERNAL = 0x0B.toByte()
    const val STATUS_TARGET_SPEED_CHANGED = 0x0C.toByte()
    const val STATUS_TARGET_INCLINATION_CHANGED = 0x0D.toByte()
    const val STATUS_TARGET_RESISTANCE_CHANGED = 0x0E.toByte()
    const val STATUS_TARGET_POWER_CHANGED = 0x0F.toByte()
    const val STATUS_TARGET_HEART_RATE_CHANGED = 0x10.toByte()
    const val STATUS_TARGETED_EXPENDED_ENERGY_CHANGED = 0x11.toByte()
    const val STATUS_TARGETED_STEPS_CHANGED = 0x12.toByte()
    const val STATUS_TARGETED_STRIDES_CHANGED = 0x13.toByte()
    const val STATUS_TARGETED_DISTANCE_CHANGED = 0x14.toByte()
    const val STATUS_TARGETED_TIME_CHANGED = 0x15.toByte()
    const val STATUS_INDOOR_BIKE_SIMULATION_PARAMETERS_CHANGED = 0x16.toByte()
    const val STATUS_WHEEL_CIRCUMFERENCE_CHANGED = 0x17.toByte()
    const val STATUS_SPIN_DOWN_STATUS = 0x18.toByte()
    const val STATUS_TARGETED_CADENCE_CHANGED = 0x19.toByte()
}
